<div class="floating-viewer-settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>Floating Viewer</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            <label class="checkbox_label">
                <input id="floating_viewer_enable" type="checkbox" />
                Enable Floating Viewer
            </label>
            <p><small>Replaces the default image viewer with a draggable and resizable window.</small></p>
            
            <hr>
            
            <h4 style="margin-top: 15px; margin-bottom: 10px;"><i class="fa-solid fa-shield-halved" style="margin-right: 6px;"></i>Interception Settings</h4>
            
            <label class="checkbox_label">
                <input id="floating_viewer_intercept_avatars" type="checkbox" />
                Intercept Chat Avatar Images
            </label>
            <p><small>When clicking on character/user avatars in the chat, use enhanced viewer instead of default popup.</small></p>
            
            <label class="checkbox_label" style="margin-top: 10px;">
                <input id="floating_viewer_intercept_gallery" type="checkbox" />
                Intercept Gallery Images
            </label>
            <p><small>When opening images from <strong>More → Show Gallery</strong>, use enhanced viewer instead of default popup.</small></p>
            
            <hr>
            
            <h4 style="margin-top: 15px; margin-bottom: 10px;"><i class="fa-solid fa-display" style="margin-right: 6px;"></i>Display Settings</h4>
            
            <div style="margin-bottom: 12px;">
                <label style="display: block; margin-bottom: 5px;">Default Image Size (%)</label>
                <input type="number" id="floating_viewer_default_size" class="text_pole" 
                       min="10" max="100" value="60" style="width: 100px;" />
                <p><small>Initial size as % of viewport (10-100). Ignored when "Remember Position & Size" is enabled.</small></p>
            </div>
            
            <label class="checkbox_label">
                <input id="floating_viewer_remember_position" type="checkbox" />
                Remember Position & Size
            </label>
            <p><small>When enabled, the viewer will open at the last used position and size until the tab is closed.</small></p>
            
            <button id="floating_viewer_clear_layout" class="menu_button" style="margin-top: 8px; margin-bottom: 5px;">
                <i class="fa-solid fa-trash-can" style="margin-right: 6px;"></i>Clear Saved Positions
            </button>
            <p><small>Clears all remembered positions and sizes.</small></p>
            
            <hr>
            
            <h4 style="margin-top: 15px; margin-bottom: 10px;"><i class="fa-solid fa-clone" style="margin-right: 6px;"></i>Multi-Image Settings</h4>
            
            <label class="checkbox_label">
                <input id="floating_viewer_multi_image" type="checkbox" />
                Allow Multiple Windows
            </label>
            <p><small>Open multiple images in separate windows simultaneously.</small></p>
            
            <div style="margin-top: 10px; margin-bottom: 12px;">
                <label style="display: block; margin-bottom: 5px;">Maximum Instances</label>
                <input type="number" id="floating_viewer_max_instances" class="text_pole" 
                       min="1" max="10" value="5" style="width: 100px;" />
                <p><small>Maximum simultaneous windows (1-10). Oldest closes when exceeded. Overridden by layout slot count when a layout is active.</small></p>
            </div>
            
            <label class="checkbox_label">
                <input id="floating_viewer_remember_layout" type="checkbox" />
                Remember Layout
            </label>
            <p><small>Remember positions for all viewer slots. Each slot (1st, 2nd, 3rd image, etc.) remembers its own position.</small></p>
            
            <label class="checkbox_label" style="margin-top: 10px;">
                <input id="floating_viewer_prevent_overlap" type="checkbox" />
                Prevent Overlap
            </label>
            <p><small>Stop viewers from overlapping each other. When dragging, viewers will not be placed on top of others.</small></p>
            
            <hr>
            
            <h4 style="margin-top: 15px; margin-bottom: 10px;"><i class="fa-solid fa-magnifying-glass-plus" style="margin-right: 6px;"></i>Zoom Settings</h4>
            
            <label class="checkbox_label">
                <input id="floating_viewer_enable_zoom" type="checkbox" />
                Enable Zoom
            </label>
            <p><small>Use scroll wheel or pinch gesture to zoom images. Pan by dragging when zoomed in.</small></p>
            
            <div style="margin-top: 10px; margin-bottom: 12px;">
                <label style="display: block; margin-bottom: 5px;">Maximum Zoom (%)</label>
                <input type="number" id="floating_viewer_max_zoom" class="text_pole" 
                       min="100" max="500" value="300" style="width: 100px;" />
                <p><small>Maximum zoom level (100-500%).</small></p>
            </div>
            
            <label class="checkbox_label">
                <input id="floating_viewer_free_pan" type="checkbox" />
                Free Pan
            </label>
            <p><small>Allow panning beyond image bounds when zoomed (creates transparent overflow effect).</small></p>
            
            <hr>
            
            <h4 style="margin-top: 15px; margin-bottom: 10px;"><i class="fa-solid fa-layer-group" style="margin-right: 6px;"></i>Image Layouts</h4>
            
            <label class="checkbox_label">
                <input id="floating_viewer_layout_enabled" type="checkbox" />
                Enable Layout System
            </label>
            <p><small>Use predefined layouts for image positioning. Automatically sets max instances to match slot count.</small></p>
            
            <div id="floating_viewer_layout_controls" style="margin-top: 10px;">
                <div style="margin-bottom: 10px;">
                    <label style="display: block; margin-bottom: 5px;">Active Layout</label>
                    <select id="floating_viewer_active_layout" class="text_pole" style="width: 200px;">
                        <option value="">None - Free positioning</option>
                        <!-- Populated dynamically -->
                    </select>
                </div>
                
                <button id="floating_viewer_open_builder" class="menu_button">
                    <i class="fa-solid fa-wrench" style="margin-right: 6px;"></i>
                    Open Layout Builder
                </button>
                
                <div style="margin-top: 12px; margin-bottom: 10px;">
                    <label style="display: block; margin-bottom: 5px;">Image Fit Mode</label>
                    <select id="floating_viewer_fit_mode" class="text_pole" style="width: 140px;">
                        <option value="classic">Classic</option>
                        <option value="cover">Cover</option>
                        <option value="contain">Contain</option>
                        <option value="stretch">Stretch</option>
                        <option value="center">Center</option>
                    </select>
                    <p><small>How images fit in layout slots. Classic = normal viewer, Cover = fill and crop, Contain = fit within, Stretch = distort to fill, Center = original size centered.</small></p>
                </div>
            </div>
            
            <hr>
            
            <h4 style="margin-top: 15px; margin-bottom: 10px;"><i class="fa-solid fa-book-open" style="margin-right: 6px;"></i>How to Use</h4>
            <ul style="margin-left: 20px; font-size: 0.9em;">
                <li><strong>Chat avatars:</strong> Click any character or user avatar in the chat</li>
                <li><strong>Gallery:</strong> Go to <strong>More → Show Gallery</strong> and click any image thumbnail</li>
                <li><strong>Move:</strong> Drag anywhere on the image to reposition</li>
                <li><strong>Resize:</strong> Drag edges or corners to resize (maintains aspect ratio)</li>
                <li><strong>Zoom:</strong> Scroll wheel to zoom in/out (zooms toward cursor)</li>
                <li><strong>Pan:</strong> When zoomed in, drag to pan around the image</li>
                <li><strong>Close:</strong> Click X button or press <strong>Escape</strong> key</li>
            </ul>
            
            <hr>
            
            <h4 style="margin-top: 15px; margin-bottom: 10px;"><i class="fa-solid fa-circle-info" style="margin-right: 6px;"></i>About</h4>
            <div style="margin-left: 20px; font-size: 0.9em;">
                <p><i class="fa-solid fa-code-branch" style="margin-right: 6px; width: 16px; text-align: center;"></i><strong>Version:</strong> 1.2.0</p>
                <p><i class="fa-solid fa-user" style="margin-right: 6px; width: 16px; text-align: center;"></i><strong>Creator:</strong> Quackified</p>
                <p><i class="fa-brands fa-github" style="margin-right: 6px; width: 16px; text-align: center;"></i><a href="" target="_blank" style="color: var(--SmartThemeQuoteColor);">GitHub Repository</a></p>
            </div>
        </div>
    </div>
</div>